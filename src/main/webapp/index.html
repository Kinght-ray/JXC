<!doctype html>

<html>
<head>    
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>超市进销存管理系统</title>
    <link rel="stylesheet" href="static/easyUI-Mini/WebContent/demo/demo.css">
    <link rel="stylesheet" href="static/easyUI-Mini/WebContent/res/third-party/scrollbar/jquery.mCustomScrollbar.css">
    <link rel="stylesheet" href="static/easyUI-Mini/WebContent/frame/frame1/res/frame.css">
    <link rel="stylesheet" href="static/easyUI-Mini/WebContent/frame/frame1/res/index.css">
    <link rel="stylesheet" href="static/easyUI-Mini/WebContent/frame/frame1/res/tabs.css">
    <link rel="stylesheet" href="static/easyUI-Mini/WebContent/frame/frame1/res/menu/menu.css">
    <script src="static/easyUI-Mini/WebContent/frame/frame1/res/menu/menu.js"></script>
    <script src="static/easyUI-Mini/WebContent/frame/frame1/res/menutip.js"></script>
    <script src="static/easyUI-Mini/WebContent/scripts/boot.js" type="text/javascript"></script>
    <script src="static/easyUI-Mini/WebContent/res/third-party/scrollbar/jquery.mCustomScrollbar.concat.min.js"></script>
    <script src="static/easyUI-Mini/WebContent/scripts/miniui/locale/zh_CN.js"></script>
    <script src="static/easyUI-Mini/WebContent/demo/datagrid/js/ColumnsMenu.js"></script>

    <!--<script type="text/javascript" src="/static/jquery-easyui-1.7.0/jquery.easyui.min.js"></script>-->

</head>
<body>
    
<div class="navbar">
    <div class="navbar-header">
        <div class="navbar-brand">超市进销存管理系统</div>
        <div class="navbar-brand navbar-brand-compact">超</div>
        <!--<div id="userInfo" class="userInfo"></div>-->
    </div>
    <ul class="nav navbar-nav">
        <li><a id="toggle"><span class="fa fa-bars" ></span></a></li>
        <li id="userInfo" class="userInfo"></li><!--加载登录用户信息-->
        <!--<li class="icontop"><a href="#"><i class="fa fa-hand-pointer-o"></i><span >系统演示</span></a></li>-->
        <!--<li class="icontop"><a href="#"><i class="fa fa-puzzle-piece"></i><span >开发文档</span></a></li>-->
        <!--<li class="icontop"><a href="#"><i class="fa fa-sort-amount-asc"></i><span >人力资源</span></a></li>-->
        <!--<li class="icontop"><a href="/admin/user/modifyPassword"><i class="fa  fa-cog"></i><span >系统设置</span></a></li>-->
    </ul>
    <ul class="nav navbar-nav navbar-right">

        <li><a href="#"><i class="mini-window"></i> 修改密码</a></li>
        <li class="dropdown">
            <a class="dropdown-toggle userinfo">
                <img class="user-img" src="static/easyUI-Mini/WebContent/frame/frame1/res/images/user.jpg " />个人资料<i class="fa fa-angle-down"></i>
            </a>
            <ul class="dropdown-menu pull-right">
                <li ><a href="/user/loadUserInfo"><i class="fa fa-eye "></i> 用户信息</a></li>
                <li><a href="/admin/user/logout"><i class="fa fa-user"></i> 退出登录</a></li>
                <li><a href="loginLayout.html"><i class="fa fa-out"></i> 修改密码</a></li>
            </ul>
        </li>
    </ul>
</div>


<div class="container">
    <div class="sidebar">
        <div class="sidebar-toggle"><i class = "fa fa-fw fa-dedent" ></i>导航栏</div>
        <div id="mainMenu" onitemselect="onItemSelect"></div>
    </div>


    <div class="main">
        <!--Tabs-->
        <div id="mainTabs" class="mini-tabs bg-toolbar" activeIndex="0" style="width:100%;height:100%;"
             bodyStyle="border:0;background:white;"
        >
            <div title="首页" url="../../common/stockSearch.html"  onItemClick = "onItemClick">
            </div>
        </div>

        <!--<div id="tabsButtons">-->
            <!--<a class="tabsBtn"><i class="fa fa-home"></i></a>-->
            <!--<a class="tabsBtn"><i class="fa fa-refresh"></i></a>-->
            <!--<a class="tabsBtn"><i class="fa fa-remove"></i></a>-->
            <!--<a class="tabsBtn"><i class="fa fa-arrows-alt"></i></a>-->
        <!--</div>-->

        <!--<div id="loginWindow" class="mini-window" title="用户登录" style="width:350px;height:165px;"-->
             <!--showModal="true" showCloseButton="false"-->
        <!--&gt;-->

            <!--<div id="loginForm" style="padding:15px;padding-top:10px;">-->
                <!--<table >-->
                    <!--<tr>-->
                        <!--<td>新密码：</td>-->
                        <!--<td><input type="password" id="newPassword" name="newPassword" class="easyui-validatebox"-->
                                   <!--required="true" style="width: 200px"/></td>-->
                    <!--</tr>-->
                    <!--<tr>-->
                        <!--<td>确认新密码：</td>-->
                        <!--<td><input type="password" id="newPassword2" name="newPassword2" class="easyui-validatebox"-->
                                   <!--required="true" style="width: 200px"/></td>-->
                    <!--</tr>-->
                    <!--<tr>-->
                        <!--<td></td>-->
                        <!--<td style="padding-top:5px;">-->
                            <!--<a onclick="modifyPassword()" class="mini-button" style="width:60px;">确认</a>-->
                            <!--<a onclick="closePasswordModifyDialog()" class="mini-button" style="width:60px;">关闭</a>-->
                        <!--</td>-->
                    <!--</tr>-->
                <!--</table>-->
            <!--</div>-->

        <!--</div>-->
        <div id="dlg" class="mini-window" style="width:400px;height:180px;padding: 10px 20px"
             closed="true" buttons="#dlg-buttons" data-options="onClose:function(){resetValue()}">

            <form id="fm" method="post">
                <table cellspacing="8px">
                    <tr>
                        <td>新密码：</td>
                        <td><input type="password" id="newPassword" name="newPassword" class="mini-button"
                                   required="true" style="width: 200px"/></td>
                    </tr>
                    <tr>
                        <td>确认新密码：</td>
                        <td><input type="password" id="newPassword2" name="newPassword2" class="mini-button"
                                   required="true" style="width: 200px"/></td>
                    </tr>
                </table>
            </form>
        </div>

        <div id="dlg-buttons">
            <a href="javascript:modifyPassword()" class="mini-button" iconCls="icon-ok">保存</a>
            <a href="javascript:closePasswordModifyDialog()" class="mini-button" iconCls="icon-cancel">关闭</a>
        </div>

        <div class = "nav navbar-na" region="south" style="height: 30px;padding: 5px" align="center">
            Copyright © 2019 ray 版权所有
        </div>

    </div>



   
</div>



<div id="menu" class="mini-butt">
    <div id="mm-tabrefresh" data-options="name:1,iconCls:'icon-refresh'"> 刷新当前标签页</div>
    <div class="menu-sep"></div>
    <div id="mm-tabclose" data-options="name:2,iconCls:'icon-closetab'">关闭当前标签页</div>
    <div id="mm-tabcloseall" data-options="name:3,iconCls:'icon-closealltab'">关闭全部标签页</div>
    <div id="mm-tabcloseother" data-options="name:4,iconCls:'icon-closeothertab'">关闭其他标签页</div>
    <div id="mm-tabcloseright" data-options="name:5,iconCls:'icon-closerighttab'">关闭右侧标签页</div>
    <div id="mm-tabcloseleft" data-options="name:6,iconCls:'icon-closelefttab'">关闭左侧标签页</div>
</div>

<script type="text/javascript">

    function activeTab(item) {
        var tabs = mini.get("mainTabs");
        var tab = tabs.getTab(item.id);
        if (!tab) {
            tab = { name: item.id, title: item.text, url: item.url, iconCls: item.iconCls, showCloseButton: true };
            tab = tabs.addTab(tab);
        }
        tabs.activeTab(tab);

    }


    $(function () {


    function logout() {
        $.messager.confirm("系统提示", "您确定要退出系统吗？", function (r) {
            if (r) {
                window.location.href = '/admin/user/logout';
            }
        });
    }

    function openPasswordModifyDialog() {
        $("#dlg").load("open").load("setTitle", "修改密码");
        url:"/admin/user/modifyPassword";
    }



        function openTab(node) {
            if ($("#tabs").tabs("exists", node.text)) {
                $("#tabs").tabs("select", node.text);
            } else {
                var content = "<iframe frameborder=0 scrolling='auto' style='width:100%;height:99%' src='" + node.attributes.url + "'></iframe>";
                $("#tabs").tabs("add", {
                    title: node.text,
                    iconCls: node.iconCls,
                    closable: true,
                    content: content
                });
            }
        }



        <!--首页-->
        function showTab(node) {
            var tabs = mini.get("mainTabs");
            var id = "tab$" + node.id;
            var tab = tabs.getTab(id);
            if (!tab) {
                tab = {};
                tab.name = id;
                tab.title = node.text;
                tab.showCloseButton = true;
                tab.url = node.url;
                // tabs.addTab(tab);
            }
            tabs.activeTab(tab);
        }
        function onItemClick(e) {
            var item = e.item;
            var isLeaf = e.isLeaf;
            if (isLeaf) {
                showTab(item);
            }
        }

        function onitemselect(e) {
            var itme  = e.item;
            iframe.src = itme.url;
        }

        //menu
        var menu = new Menu("#mainMenu", {
            itemclick: function (item) {
                if (!item.children) {
                    activeTab(item);
                }
            },
            onClick: function (node) {
                if (node.id == 6050) {
                    logout();
                } else if (node.id == 6040) {
                    openPasswordModifyDialog();
                } else if (node.attributes.url) {
                    openTab(node);
                }
            }
        });

        $("#userInfo").load("/user/loadUserInfo"); // 加载用户信息

        $(".sidebar").mCustomScrollbar({ autoHideScrollbar: true });

        new MenuTip(menu);

        $.ajax({
            url: "data/menu.txt",
            success: function (text) {
                var data = mini.decode(text);
                menu.loadData(data);
            }

        });



        //toggle
        $("#toggle, .sidebar-toggle").click(function () {
            $('body').toggleClass('compact');
            mini.layout();
        });

        $("#dlg").click(function (node) {
            // onClick: function (node) {
                if (node.id == 6050) {
                    logout();
                } else if (node.id == 6040) {
                    openPasswordModifyDialog();
                } else if (node.attributes.url) {
                    openTab(node);
                }

        })

        //dropdown
        $(".dropdown-toggle").click(function (event) {
            $(this).parent().addClass("open");
            return false;
        });

        $(document).click(function (event) {
            $(".dropdown").removeClass("open");
        });

        function modifyPassword() {
            $("#fm").form("submit", {
                url: url,
                onSubmit: function () {
                    var newPassword = $("#newPassword").val();
                    var newPassword2 = $("#newPassword2").val();
                    if (!$(this).form("validate")) {
                        return false;
                    }
                    if (newPassword != newPassword2) {
                        $.messager.alert("系统提示", "确认密码输入错误！");
                        return false;
                    }
                    return true;
                },
                success: function (result) {
                    var result = eval('(' + result + ')');
                    if (result.success) {
                        $.messager.alert("系统提示", "密码修改成功，下一次登录生效！");
                        resetValue();
                        $("#dlg").dialog("close");
                    } else {
                        $.messager.alert("系统提示", "密码修改失败！");
                        return;
                    }
                }
            });
        }

        function closePasswordModifyDialog() {
            resetValue();
            $("#dlg").dialog("close");
        }

        function resetValue() {
            $("#newPassword").val("");
            $("#newPassword2").val("");
        }
    });

</script>


</body>
</html>

